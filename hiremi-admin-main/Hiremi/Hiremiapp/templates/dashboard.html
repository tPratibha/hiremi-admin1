{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://kit.fontawesome.com/861ce09321.js" crossorigin="anonymous"></script>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="https://code.jquery.com/jquery-3.7.1.js" ></script>
    <script src="{% static "js/activePage.js" %}"></script>
    <script src="{% static "js/sort-table.js" %}"></script>
    <script>
        $(document).ready(function(){
            $('#btn').click(function(){
                $('header nav ul').toggleClass('show');
            });
        })
        const pathName = window.location.pathname;
         const pageName=pathName.split("/").pop();
         if(pageName ===  "dashboard.html" ){
            document.querySelector(".dashboard").classList.add("activeLink");
         }
            if(pageName === "Mentoreship.html"){
            document.querySelector(".Mentorship ").classList.add("activeLink");
         }
         </script>
         <script>
//         document.addEventListener('DOMContentLoaded', () => {
//     const links = document.querySelectorAll('.nav-link');

//     links.forEach(link => {
//         link.addEventListener('click', function() {
//             // Remove active class from all links
//             links.forEach(link => link.classList.remove('active'));
            
//             // Add active class to the clicked link
//             this.classList.add('active');
//         });
//     });
// });
// active link

// document.addEventListener('DOMContentLoaded', () => {
//     const links = document.querySelectorAll('.nav-link');

//     // Restore active link from local storage
//     const activeLinkId = localStorage.getItem('activeLinkId');
//     if (activeLinkId) {
//         const activeLink = document.getElementById(activeLinkId);
//         if (activeLink) {
//             activeLink.classList.add('active');
//         }
//     }

//     // Add click event listener to each link
//     links.forEach(link => {
//         link.addEventListener('click', function() {
//             // Remove active class from all links
//             links.forEach(link => link.classList.remove('active'));
            
//             // Add active class to the clicked link
//             this.classList.add('active');
            
//             // Save the active link ID to local storage
//             localStorage.setItem('activeLinkId', this.id);
//         });
//     });
// });

// sorting table
// let sortOrder = -1;
// function sortTable1(columnIndex) {
//     const table = document.getElementById("sortableTable");
//     const rows = Array.from(table.rows).slice(1); // Skip the header row
//     const isNumeric = !isNaN(rows[0].cells[columnIndex].innerText);
//  sortOrder *= -1;
//     rows.sort((rowA, rowB) => {
//         const cellA = rowA.cells[columnIndex].innerText;
//         const cellB = rowB.cells[columnIndex].innerText;

//         if (isNumeric) {
//             return parseFloat(cellB) - parseFloat(cellA)*sortOrder;
//         } else {
//             return cellB.localeCompare(cellA)*sortOrder;
//         }
//     });

//     // Append sorted rows to the table body
//     rows.forEach(row => table.tBodies[0].appendChild(row));
// }


// const sortOrders = {
//     2: 'desc', // Download App column starts descending
//     3: 'desc', // Accounts Verified column starts descending
//     4: 'desc'  // Non-Verified Accounts column starts descending
// };

// function sortTable(columnIndex) {
//     const table = document.getElementById("sortableTable");
//     const rows = Array.from(table.rows).slice(1); // Skip the header row
//     const isNumeric = !isNaN(rows[0].cells[columnIndex].innerText);

//     // Toggle sort order for the column
//     sortOrders[columnIndex] = sortOrders[columnIndex] === 'asc' ? 'desc' : 'asc';
//     const sortOrder = sortOrders[columnIndex];

//     rows.sort((rowA, rowB) => {
//         const cellA = rowA.cells[columnIndex].innerText;
//         const cellB = rowB.cells[columnIndex].innerText;

//         if (isNumeric) {
//             return sortOrder === 'desc'
//                 ? parseFloat(cellB) - parseFloat(cellA)
//                 : parseFloat(cellB) - parseFloat(cellA);
//         } else {
//             return sortOrder === 'asc'
//                 ? cellB.localeCompare(cellA)
//                 : cellB.localeCompare(cellA);
//         }
//     });

//     // Append sorted rows to the table body
//     rows.forEach(row => table.tBodies[0].appendChild(row));
// }

// script.js

// script.js

// function sortTable(columnName) {
//     var table, rows, switching, i, x, y, shouldSwitch;
//     table = document.getElementById("sortableTable");
//     switching = true;
//     while (switching) {
//         switching = false;
//         rows = table.rows;
//         for (i = 1; i < (rows.length - 1); i++) {
//             shouldSwitch = false;
//             x = rows[i].getElementsByTagName("TD")[columnName].innerHTML;
//             y = rows[i + 1].getElementsByTagName("TD")[columnName].innerHTML;
//             if (columnName === 'download' || columnName === 'verified' || columnName === 'non-verified') {
//                 x = parseInt(x);
//                 y = parseInt(y);
//             }
//             if (x < y) {
//                 shouldSwitch = true;
//                 break;
//             }
//         }
//         if (shouldSwitch) {
//             rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
//             switching = true;
//         }
//     }
// }





    </script>
    

    <title>State Ranking</title>
    <link rel="stylesheet" href="{% static "css/dashboard.css" %}">
</head>
<body>
    <header>
        <h1><img class="logo" src="{% static "asset/icon.png" %}" alt=""></h1>
        <p>Super Admin</p>   
            <nav  class="nav-link">
                <ul>
                    <li></li>
                    <li> <a  id="dashboard-link"  href="{% url 'dashboard' %}"><i class='bx bx-home-alt'></i> Dashboard</a></li>
                    <li><a  id="Analytics-link" href="#"><i class="fa-solid fa-chart-simple"></i> Analytics</a></li>
                    <li><a   id="App Download-link" href="#"><i class="fa-solid fa-file-arrow-down"></i> App Download Status</a></li>
                    <li><a  id="Mentorship-link" href="{% url 'Mentoreship' %}"><i class='bx bxs-graduation'></i> Mentorship</a></li>
                    <li><a  id="Internship-link" href="{% url 'internship' %}"><i class="fa-solid fa-desktop"></i> Internship</a></li>
                    <li><a id="Fresher-link" href="{% url 'fresher' %}"><i class="fa-solid fa-laptop-code"></i> Fresher</a></li>
                    <li><a  id="Experience-link" href="#"><i class='bx bx-briefcase'></i> Experience</a></li>
                    <li><a  id="Corporate_training-link" href="{% url 'corporate_training' %}"><i class="fa-solid fa-folder-tree"></i> Corporate Training</a></li>
                    <li><a  id="Mentorship-link" href="#"><i class="fa-regular fa-file"></i> Courses</a></li>
                    <li><a id="Mentorship-link" href="#"><i class='bx bxs-report'></i> Project Report</a></li>
                    <li><a  href="#"><i class="fa-regular fa-user"></i> Admin Settings</a></li>
                    <li><a href="{% url 'superuser_logout' %}"><i class="fa-solid fa-arrow-right-from-bracket"></i> Logout</a></li>
                </ul>
            </nav>
                <label id="btn">
               <i class="fa-solid fa-bars" ></i>
         
               </label>
    </header>
    <div class="search" class=>
        <div class="sec-inp">
            <div class="inp-bg">
                <i class="fa-solid fa-magnifying-glass"></i>
                <input type="text" placeholder="Search">
                <img src="../static/asset/logo.jpg" alt="">
            </div>
        </div>
    </div>
    <div class="account">
        <div class="ac-in">
            <h4 class="title">Account Status All</h4>
        </div>
        <div class="statement">
            <div class="ac-st">
                <div class="icon">
                    <i class="fa-solid fa-user"></i>
                </div>
                <div class="state">
                    <h3>{{user_count}}</h3>
                    <p1>Total Accounts Created</p1>
                    <p><a class="view" href="{% url "dashboard1" %}">View All</a> <i class="fa-solid fa-arrow-right"></i></p>
                </div>
                <div class="sub-st">
                    <p1>+{{current_month_registrations}}%</p1>
                    <p>This month</p>
                </div>
            </div>
            <br>
            <div class="ac-st">
                <div class="icon">
                    <i class="fa-solid fa-circle-check"></i>
                </div>
                <div class="state">
                    <h3>{{verified_count}}</h3>
                    <p1>Total Accounts Verified</p1>
                    <p><a class="view" href="{% url "dashboard2" %}">view All</a> <i class="fa-solid fa-arrow-right"></i></p>
                </div>
                <div class="sub-st">
                    <p1>+32%</p1>
                    <p>This month</p>
                </div>
            </div>
        </div>
        <div class="statement">
            <div class="ac-st">
                <div class="icon">
                    <i class="fa-solid fa-credit-card"></i>
                </div>
                <div class="state">
                    <h3>{{payment_count}}</h3>
                    <p1>Payment Done (Under Verification)</p1>
                    <p><a class="view" href="{% url "dashboard3" %}">view All</a> <i class="fa-solid fa-arrow-right"></i></p>
                </div>
                <div class="sub-st">
                    <p1>+32%</p1>
                    <p>This month</p>
                </div>
            </div>
            <br>
            <div class="ac-st">
                <div class="icon">
                    <i class="fa-solid fa-file-circle-xmark"></i>
                </div>
                <div class="state">
                    <h3>{{unverified_count}}</h3>
                    <p1>Non-Verified Accounts</p1>
                    <p><a class="view" href="{% url "dashboard4" %}">view All</a> <i class="fa-solid fa-arrow-right"></i></p>
                </div>
                <div class="sub-st">
                    <p1>+40%</p1>
                    <p>This month</p>
                </div><br>
            </div>
        </div><br><br><br><br>
        <div class="list">
            <h4 class="title">State Ranking</h4>
        </div><br>
        <div class="list-items">
              <ul class="buttons">
                <li  id="downloadBtn"> <a  onclick="sortTable('download')" href="#">Download App</a></li>
               <li id="verifiedBtn"> <a  onclick="sortTable('verified')" href="#">Accounts Verified</a></li>
                <li id="nonVerifiedBtn"> <a  onclick="sortTable('non-verified')"  href="#">Non-Verified Accounts</a></li>
            </ul>

            {% comment %} <div>
                <button onclick="sortStates('total')">Sort by Total</button>
                <button onclick="sortStates('verified')">Sort by Verified</button>
                <button onclick="sortStates('unverified')">Sort by Unverified</button>
            </div> {% endcomment %}
        </div><br><br>
        <div class="list1">
            <div class="list-type">
                <table id="sortableTable">
                    <thead>
                        <tr>
                            <th>S.NO</th>
                            <th>State List</th>
                            <th>Download App</th>
                            <th>Account Verified</th>
                            <th>Non-Verified Account</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for state, counts in state_counts.items %}
                        <tr>
                            <td>{{ forloop.counter }}</td>
                            <td>{{ state }}</td>
                            <td>{{ counts.total }}</td>
                            <td>{{ counts.verified }}</td>
                            <td>{{ counts.unverified }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
</body>
</html>